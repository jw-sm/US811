STREET_ABBREVIATIONS = {
    # Street Types
    "AL": "ALLEY",
    "ALY": "ALLEY",
    "ANX": "ANNEX",
    "ARC": "ARCADE",
    "AVE": "AVENUE",
    "AV": "AVENUE",
    "BAYOO": "BAYOU",
    "BCH": "BEACH",
    "BND": "BEND",
    "BLF": "BLUFF",
    "BLFS": "BLUFFS",
    "BLVD": "BOULEVARD",
    "BR": "BRIDGE",
    "BRG": "BRIDGE",
    "BRK": "BROOK",
    "BRKS": "BROOKS",
    "BG": "BURG",
    "BGS": "BURGS",
    "BYP": "BYPASS",
    "CP": "CAMP",
    "CYN": "CANYON",
    "CPE": "CAPE",
    "CSWY": "CAUSEWAY",
    "CTR": "CENTER",
    "CTRS": "CENTERS",
    "CIR": "CIRCLE",
    "CIRC": "CIRCLE",
    "CIRS": "CIRCLES",
    "CLF": "CLIFF",
    "CLFS": "CLIFFS",
    "CLB": "CLUB",
    "CMNS": "COMMON",
    "COR": "CORNER",
    "CORS": "CORNERS",
    "CRSE": "COURSE",
    "CT": "COURT",
    "CTS": "COURTS",
    "CV": "COVE",
    "CVS": "COVES",
    "CRK": "CREEK",
    "CRES": "CRESCENT",
    "CRST": "CREST",
    "XING": "CROSSING",
    "XRD": "CROSSROAD",
    "XRDS": "CROSSROADS",
    "CURV": "CURVE",
    "DL": "DALE",
    "DM": "DAM",
    "DV": "DIVIDE",
    "DR": "DRIVE",
    "DRS": "DRIVES",
    "EST": "ESTATE",
    "ESTS": "ESTATES",
    "EXP": "EXPRESSWAY",
    "EXPY": "EXPRESSWAY",
    "EXT": "EXTENSION",
    "EXTS": "EXTENSIONS",
    "FRY": "FERRY",
    "FLD": "FIELD",
    "FLDS": "FIELDS",
    "FLT": "FLAT",
    "FLTS": "FLATS",
    "FRD": "FORD",
    "FRDS": "FORDS",
    "FRST": "FOREST",
    "FRG": "FORGE",
    "FRGS": "FORGES",
    "FRK": "FORK",
    "FRKS": "FORKS",
    "FT": "FORT",
    "FWY": "FREEWAY",
    "GDN": "GARDEN",
    "GDNS": "GARDENS",
    "GTWY": "GATEWAY",
    "GLN": "GLEN",
    "GLNS": "GLENS",
    "GRN": "GREEN",
    "GRNS": "GREENS",
    "GRV": "GROVE",
    "GRVS": "GROVES",
    "HBR": "HARBOR",
    "HBRS": "HARBORS",
    "HVN": "HAVEN",
    "HTS": "HEIGHTS",
    "HWY": "HIGHWAY",
    "HL": "HILL",
    "HLS": "HILLS",
    "HOLW": "HOLLOW",
    "INLT": "INLET",
    "IS": "ISLAND",
    "ISS": "ISLANDS",
    "ISLE": "ISLE",
    "JCT": "JUNCTION",
    "JCTS": "JUNCTIONS",
    "KY": "KEY",
    "KYS": "KEYS",
    "KNL": "KNOLL",
    "KNLS": "KNOLLS",
    "LK": "LAKE",
    "LKS": "LAKES",
    "LAND": "LAND",
    "LNDG": "LANDING",
    "LN": "LANE",
    "LGT": "LIGHT",
    "LGTS": "LIGHTS",
    "LF": "LOAF",
    "LCK": "LOCK",
    "LCKS": "LOCKS",
    "LDG": "LODGE",
    "LWR": "LOWER",
    "MALL": "MALL",
    "MNR": "MANOR",
    "MNRS": "MANORS",
    "MDW": "MEADOW",
    "MDWS": "MEADOWS",
    "ML": "MILL",
    "MLS": "MILLS",
    "MSN": "MISSION",
    "MTWY": "MOTORWAY",
    "MT": "MOUNT",
    "MTN": "MOUNTAIN",
    "MTNS": "MOUNTAINS",
    "NCK": "NECK",
    "ORCH": "ORCHARD",
    "OVL": "OVAL",
    "OPAS": "OVERPASS",
    "PARK": "PARK",
    "PKWY": "PARKWAY",
    "PASS": "PASS",
    "PSGE": "PASSAGE",
    "PATH": "PATH",
    "PIKE": "PIKE",
    "PNE": "PINE",
    "PNES": "PINES",
    "PL": "PLACE",
    "PLN": "PLAIN",
    "PLNS": "PLAINS",
    "PLZ": "PLAZA",
    "PTS": "POINTS",
    "PRT": "PORT",
    "PRTS": "PORTS",
    "PR": "PRAIRIE",
    "RADL": "RADIAL",
    "RAMP": "RAMP",
    "RNCH": "RANCH",
    "RPD": "RAPID",
    "RPDS": "RAPIDS",
    "RST": "REST",
    "RDG": "RIDGE",
    "RDGS": "RIDGES",
    "RIV": "RIVER",
    "RD": "ROAD",
    "RDS": "ROADS",
    "RTE": "ROUTE",
    "ROW": "ROW",
    "RUE": "RUE",
    "RUN": "RUN",
    "SHL": "SHOAL",
    "SHLS": "SHOALS",
    "SHR": "SHORE",
    "SHRS": "SHORES",
    "SKWY": "SKYWAY",
    "SPG": "SPRING",
    "SPGS": "SPRINGS",
    "SPUR": "SPUR",
    "SQ": "SQUARE",
    "SQS": "SQUARES",
    "STRA": "STRAVENUE",
    "STRM": "STREAM",
    "ST": "STREET",
    "STR": "STREET",
    "STE": "SUITE",
    "SMT": "SUMMIT",
    "TER": "TERRACE",
    "TRCE": "TRACE",
    "TRK": "TRACK",
    "TRFY": "TRAFFICWAY",
    "TRL": "TRAIL",
    "TRLR": "TRAILER",
    "TUNL": "TUNNEL",
    "TPKE": "TURNPIKE",
    "UPAS": "UNDERPASS",
    "UN": "UNION",
    "UNS": "UNIONS",
    "VLY": "VALLEY",
    "VLYS": "VALLEYS",
    "VIAD": "VIADUCT",
    "VW": "VIEW",
    "VWS": "VIEWS",
    "VLG": "VILLAGE",
    "VLGS": "VILLAGES",
    "VL": "VILLE",
    "VIS": "VISTA",
    "WALK": "WALK",
    "WALL": "WALL",
    "WAY": "WAY",
    "WAYS": "WAYS",
    "WL": "WELL",
    "WLS": "WELLS",
    # Directionals
    "N": "NORTH",
    "S": "SOUTH",
    "E": "EAST",
    "W": "WEST",
    "NE": "NORTHEAST",
    "NW": "NORTHWEST",
    "SE": "SOUTHEAST",
    "SW": "SOUTHWEST",
    # Special cases
    "BLDG": "BUILDING",
    "FNT": "FRONTAGE",
    "HSE": "HOUSE",
    "LOT": "LOT",
    "OFC": "OFFICE",
    "PK": "PARK",
    "PH": "PHONE",
    "RM": "ROOM",
    "SLIP": "SLIP",
    "STA": "STATION",
    "UNIT": "UNIT",
    "WING": "WING",
}


def normalize(name: str) -> str:
    """
    Normalize street names for consistent matching.

    Examples:
    - "W Fordson Dr" -> "WEST FORDSON DRIVE"
    - "123 Main St." -> "123 MAIN STREET"
    - "1st Ave" -> "1ST AVENUE"
    """
    import re

    if not name:
        return ""

    # Convert to uppercase and remove extra whitespace
    name = name.strip().upper()

    # Remove periods but keep other punctuation for now
    name = name.replace(".", "")

    # Remove non-alphanumeric characters except spaces and numbers
    name = re.sub(r"[^\w\s]", "", name)

    # Split into words
    words = name.split()
    normalized_words = []

    for word in words:
        # Skip empty words
        if not word:
            continue

        # Handle ordinals like 1ST, 2ND, 3RD, 74TH
        if re.fullmatch(r"\d+(ST|ND|RD|TH)", word):
            normalized_words.append(word)
            continue

        # Handle pure numbers (house numbers, etc.)
        if word.isdigit():
            normalized_words.append(word)
            continue

        # Look up abbreviation, keep original if not found
        normalized_word = STREET_ABBREVIATIONS.get(word, word)
        normalized_words.append(normalized_word)

    return " ".join(normalized_words)


# Test the function
if __name__ == "__main__":
    test_cases = [
        "W Fordson Dr",
        "123 Main St.",
        "1st Ave",
        "N. Highland Blvd",
        "Oak Street",
        "E 42nd St",
        "Sunset Pkwy.",
    ]

    print("Testing normalization:")
    for test in test_cases:
        print(f"'{test}' -> '{normalize(test)}'")
